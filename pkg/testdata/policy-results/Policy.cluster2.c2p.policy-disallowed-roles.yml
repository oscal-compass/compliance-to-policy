apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"policy.open-cluster-management.io/v1","kind":"Policy","metadata":{"annotations":{"policy.open-cluster-management.io/categories":"","policy.open-cluster-management.io/controls":"ac-6","policy.open-cluster-management.io/standards":""},"name":"policy-disallowed-roles","namespace":"c2p"},"spec":{"disabled":false,"policy-templates":[{"objectDefinition":{"apiVersion":"policy.open-cluster-management.io/v1","kind":"ConfigurationPolicy","metadata":{"name":"policy-disallowed-roles"},"spec":{"namespaceSelector":{"exclude":["kube-system","open-cluster-management","open-cluster-management-agent","open-cluster-management-agent-addon"],"include":["*"]},"object-templates":[{"complianceType":"mustnothave","objectDefinition":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]}]}}],"remediationAction":"inform","severity":"high"}}}],"remediationAction":"inform"}}
    policy.open-cluster-management.io/categories: ""
    policy.open-cluster-management.io/controls: ac-6
    policy.open-cluster-management.io/standards: ""
  creationTimestamp: "2023-07-05T23:51:43Z"
  generation: 1
  labels:
    policy.open-cluster-management.io/cluster-name: cluster2
    policy.open-cluster-management.io/cluster-namespace: cluster2
    policy.open-cluster-management.io/root-policy: c2p.policy-disallowed-roles
  name: c2p.policy-disallowed-roles
  namespace: cluster2
  resourceVersion: "58171"
  uid: fb2bed28-f7be-4ad3-9df2-00f26600feb7
spec:
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-disallowed-roles
        spec:
          namespaceSelector:
            exclude:
              - kube-system
              - open-cluster-management
              - open-cluster-management-agent
              - open-cluster-management-agent-addon
            include:
              - '*'
          object-templates:
            - complianceType: mustnothave
              objectDefinition:
                apiVersion: rbac.authorization.k8s.io/v1
                kind: Role
                rules:
                  - apiGroups:
                      - '*'
                    resources:
                      - '*'
                    verbs:
                      - '*'
          remediationAction: inform
          severity: high
  remediationAction: inform
status:
  compliant: Compliant
  details:
    - compliant: Compliant
      history:
        - eventName: c2p.policy-disallowed-roles.176f1dc36e36b7b2
          lastTimestamp: "2023-07-05T23:51:50Z"
          message: Compliant; notification - roles in namespace cluster2; in namespace default; in namespace kube-node-lease; in namespace kube-public; in namespace local-path-storage missing as expected, therefore this Object template is compliant
        - eventName: c2p.policy-disallowed-roles.176f1bf28b48947f
          lastTimestamp: "2023-07-05T23:18:33Z"
          message: Compliant; notification - roles in namespace cluster2; in namespace default; in namespace kube-node-lease; in namespace kube-public; in namespace local-path-storage missing as expected, therefore this Object template is compliant
      templateMeta:
        creationTimestamp: null
        name: policy-disallowed-roles
