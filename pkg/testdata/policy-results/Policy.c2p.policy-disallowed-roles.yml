apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"policy.open-cluster-management.io/v1","kind":"Policy","metadata":{"annotations":{"policy.open-cluster-management.io/categories":"","policy.open-cluster-management.io/controls":"ac-6","policy.open-cluster-management.io/standards":""},"name":"policy-disallowed-roles","namespace":"c2p"},"spec":{"disabled":false,"policy-templates":[{"objectDefinition":{"apiVersion":"policy.open-cluster-management.io/v1","kind":"ConfigurationPolicy","metadata":{"name":"policy-disallowed-roles"},"spec":{"namespaceSelector":{"exclude":["kube-system","open-cluster-management","open-cluster-management-agent","open-cluster-management-agent-addon"],"include":["*"]},"object-templates":[{"complianceType":"mustnothave","objectDefinition":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]}]}}],"remediationAction":"inform","severity":"high"}}}],"remediationAction":"inform"}}
    policy.open-cluster-management.io/categories: ""
    policy.open-cluster-management.io/controls: ac-6
    policy.open-cluster-management.io/standards: ""
  creationTimestamp: "2023-07-05T16:10:56Z"
  generation: 2
  name: policy-disallowed-roles
  namespace: c2p
  resourceVersion: "58945"
  uid: 3aa8b4b0-6aa0-4635-a55d-342a9f38660e
spec:
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-disallowed-roles
        spec:
          namespaceSelector:
            exclude:
              - kube-system
              - open-cluster-management
              - open-cluster-management-agent
              - open-cluster-management-agent-addon
            include:
              - '*'
          object-templates:
            - complianceType: mustnothave
              objectDefinition:
                apiVersion: rbac.authorization.k8s.io/v1
                kind: Role
                rules:
                  - apiGroups:
                      - '*'
                    resources:
                      - '*'
                    verbs:
                      - '*'
          remediationAction: inform
          severity: high
  remediationAction: inform
status:
  compliant: Compliant
  placement:
    - placement: placement-managed-kubernetes
      placementBinding: policy-set
      policySet: managed-kubernetes
  status:
    - clustername: cluster1
      clusternamespace: cluster1
      compliant: Compliant
    - clustername: cluster2
      clusternamespace: cluster2
      compliant: Compliant
